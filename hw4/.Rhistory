select(-observation_id) |>
prcomp()
scores <- full_pca |>
tidy(matrix = "scores") |>
pivot_wider(names_from = PC,
values_from = value,
names_prefix = "PC")
variances <- full_pca |>
tidy(matrix = "pcs")
variances
full_pca |>
tidy(matrix = "pcs") |>
select(PC, percent) |>
head(6)
variances <- full_pca |>
tidy(matrix = "pcs")
variances |>
select(PC, percent) |>
head(6)
full_pca <- one_image_data |>
select(-observation_id) |>
prcomp()
scores <- full_pca |>
tidy(matrix = "scores") |>
pivot_wider(names_from = PC,
values_from = value,
names_prefix = "PC")
variances <- full_pca |>
tidy(matrix = "pcs")
variances |>
select(PC, percent) |>
head(6)
variances
variances[9]
variances
variances |>
filter(PC, cumulative)
variances |>
select(PC, cumulative)
variances |>
select(PC, cumulative) |>
filter(PC>8 & PC <30)
variances |>
select(PC, cumulative) |>
filter(PC== 99 & PC == 784)
variances |>
select(PC, cumulative) |>
filter(PC == 99 | PC == 784)
variances$cumulative[PC==100]
variances |>
select(PC, cumulative) |>
filter(PC == 99 | PC == 784)
variances$cumulative[99]
variances$cumulative[784] - variances$cumulative[99]
full_pca
full_pca |>
glimpse()
loadings <- full_pca |>
tidy(matrix = "loadings")
loadings
loadings <- full_pca |>
tidy(matrix = "loadings") |>
separate(col = column, into = c("x", "y"), sep = "_", convert = TRUE)
loadings <- full_pca |>
tidy(matrix = "loadings") |>
separate(col = column, into = c("x", "y"), sep = "_", convert = TRUE)
loadings
loadings <- full_pca |>
tidy(matrix = "loadings") |>
separate(col = column, into = c("x", "y"), sep = "_") |>
mutate(x = as.numeric(gsub("x","",x)),
y = as.numeric(gsub("y","",y)))
loadings
loadings <- full_pca |>
tidy(matrix = "loadings") |>
separate(col = column, into = c("x", "y"), sep = "_") |>
mutate(x = as.numeric(gsub("x","",x)),
y = as.numeric(gsub("y","",y))) |>
filter(PC <= 6)
loadings
ggplot(loadings, aes(x = as.numeric(x), y = as.numeric(y), fill = value)) +
geom_raster() +
scale_fill_gradient(low = "brown", high = "darkslateblue") +
facet_wrap(~ PC, ncol = 3) +  # Facet by PC, with 3 columns
labs(title = "Facet Plot with PC as Groups")
ggplot(loadings, aes(x = as.numeric(x), y = as.numeric(y), fill = value)) +
geom_raster() +
scale_fill_gradient(low = "brown", midpoint = middle_value, high = "darkslateblue", mid = "white") +
facet_wrap(~ PC, ncol = 3) +  # Facet by PC, with 3 columns
labs(title = "Facet Plot with PC as Groups")
ggplot(loadings, aes(x = as.numeric(x), y = as.numeric(y), fill = value)) +
geom_raster() +
scale_fill_gradient(low = "brown", midpoint = 0, high = "darkslateblue", mid = "white") +
facet_wrap(~ PC, ncol = 3) +  # Facet by PC, with 3 columns
labs(title = "Facet Plot with PC as Groups")
ggplot(loadings, aes(x = as.numeric(x), y = as.numeric(y), fill = value)) +
geom_raster() +
scale_fill_gradient(low = "brown", high = "darkslateblue", mid = "white") +
facet_wrap(~ PC, ncol = 3) +  # Facet by PC, with 3 columns
labs(title = "Facet Plot with PC as Groups")
ggplot(loadings, aes(x = as.numeric(x), y = as.numeric(y), fill = value)) +
geom_raster() +
scale_fill_gradient(low = "brown", high = "darkslateblue", midpoint = "white") +
facet_wrap(~ PC, ncol = 3) +  # Facet by PC, with 3 columns
labs(title = "Facet Plot with PC as Groups")
ggplot(loadings, aes(x = as.numeric(x), y = as.numeric(y), fill = value)) +
geom_raster() +
scale_fill_gradient(low = "brown", high = "darkslateblue", mid = "white") +
facet_wrap(~ PC, ncol = 3) +  # Facet by PC, with 3 columns
labs(title = "Facet Plot with PC as Groups")
ggplot(loadings, aes(x = as.numeric(x), y = as.numeric(y), fill = value)) +
geom_raster() +
scale_fill_gradient(low = "brown", mid = "white", high = "darkslateblue") +
facet_wrap(~ PC, ncol = 3) +  # Facet by PC, with 3 columns
labs(title = "Facet Plot with PC as Groups")
ggplot(loadings, aes(x = as.numeric(x), y = as.numeric(y), fill = value)) +
geom_raster() +
scale_fill_gradient2(low = muted("red"),
mid = "white",
high = muted("blue"),
midpoint = 0) +
facet_wrap(~ PC, ncol = 3) +  # Facet by PC, with 3 columns
labs(title = "Facet Plot with PC as Groups")
ggplot(loadings, aes(x = as.numeric(x), y = as.numeric(y), fill = value)) +
geom_raster() +
scale_fill_gradient2(low = "brown",
mid = "white",
high = "darkslateblue",
midpoint = 0) +
facet_wrap(~ PC, ncol = 3) +  # Facet by PC, with 3 columns
labs(title = "Facet Plot with PC as Groups")
ggplot(loadings, aes(x = as.numeric(x), y = as.numeric(y), fill = value)) +
geom_raster() +
scale_fill_gradient2(low = "brown",
mid = "white",
high = "darkslateblue",
midpoint = 0) +
facet_wrap(~ PC, ncol = 3) +  # Facet by PC, with 3 columns
labs(x = x,
y = y)
ggplot(loadings, aes(x = as.numeric(x), y = as.numeric(y), fill = value)) +
geom_raster() +
scale_fill_gradient2(low = "brown",
mid = "white",
high = "darkslateblue",
midpoint = 0) +
facet_wrap(~ PC, ncol = 3) +
labs(x = x,
y = y)
ggplot(loadings, aes(x = as.numeric(x), y = as.numeric(y), fill = value)) +
geom_raster() +
scale_fill_gradient2(low = "brown",
mid = "white",
high = "darkslateblue",
midpoint = 0) +
facet_wrap(~ PC, ncol = 3) +
labs(x = "x",
y = "y")
ggplot(loadings, aes(x = as.numeric(x), y = as.numeric(y), fill = value)) +
geom_raster() +
scale_fill_gradient2(low = "brown",
mid = "white",
high = "darkslateblue",
midpoint = 0) +
facet_wrap(~ PC, ncol = 3) +
labs(x = "x",
y = "y",
fill = "loading value")
scores_wider
scores_wider |>
sort(desc(PC1))
scores_wider |>
sort(desc("PC1"))
scores_wider
scores_wider |>
arrange(desc(PC1))
ggplot(loadings, aes(x = as.numeric(x), y = as.numeric(y), fill = value)) +
geom_raster() +
scale_fill_gradient2(low = "brown",
mid = "white",
high = "darkslateblue",
midpoint = 0) +
facet_wrap(~ PC, ncol = 3,
labeller = labeller(PC = function(x) paste("PC", x))) +
labs(x = "x",
y = "y",
fill = "loading value")
ggplot(loadings, aes(x = as.numeric(x), y = as.numeric(y), fill = value)) +
geom_raster() +
scale_fill_gradient2(low = "brown",
mid = "white",
high = "darkslateblue",
midpoint = 0) +
facet_wrap(~ PC, ncol = 3,
labeller = labeller(PC = function(x) paste("PC",x))) +
labs(x = "x",
y = "y",
fill = "loading value")
ggplot(loadings, aes(x = as.numeric(x), y = as.numeric(y), fill = value)) +
geom_raster() +
scale_fill_gradient2(low = "brown",
mid = "white",
high = "darkslateblue",
midpoint = 0) +
facet_wrap(~ PC, ncol = 3,
labeller = labeller(PC = function(x) paste0("PC",x))) +
labs(x = "x",
y = "y",
fill = "loading value")
scores
scores |>
arrange(desc(PC1))
scores <- scores |>
select(row, PC1, PC2, PC3, PC4)
scores |>
arrange(desc(PC1))
scores <- scores |>
select(row, PC1, PC2, PC3, PC4)
pc1_high |>
arrange(desc(PC1)) |>
head(4)
scores <- scores |>
select(row, PC1, PC2, PC3, PC4)
pc1_high <- scores |>
arrange(desc(PC1)) |>
head(4)
scores <- scores |>
select(row, PC1, PC2, PC3, PC4)
pc1_high <- scores |>
arrange(desc(PC1)) |>
head(4) |>
observation_id
scores <- scores |>
select(row, PC1, PC2, PC3, PC4)
pc1_high <- scores |>
arrange(desc(PC1)) |>
head(4) |>
select(observation_id)
scores <- scores |>
select(row, PC1, PC2, PC3, PC4)
pc1_high <- scores |>
arrange(desc(PC1)) |>
head(4) |>
select(row)
scores <- scores |>
select(row, PC1, PC2, PC3, PC4)
pc1_high <- scores |>
arrange(desc(PC1)) |>
head(4) |>
select(row) |>
as.vector()
pc1_high
scores <- scores |>
select(row, PC1, PC2, PC3, PC4)
pc1_high <- scores |>
arrange(desc(PC1)) |>
head(4) |>
select(row) |>
as.vector()
one_image_data_tidy |>
filter(observation_id in pc1_high) |>
scores <- scores |>
select(row, PC1, PC2, PC3, PC4)
pc1_high <- scores |>
arrange(desc(PC1)) |>
head(4) |>
select(row) |>
as.vector()
one_image_data_tidy |>
filter(observation_id |> in |> pc1_high) |>
scores <- scores |>
select(row, PC1, PC2, PC3, PC4)
pc1_high <- scores |>
arrange(desc(PC1)) |>
head(4) |>
select(row) |>
as.vector()
one_image_data_tidy |>
filter(observation_id %in% pc1_high) |>
ggplot(aes(x = as.numeric(x), y = as.numeric(y), fill = value)) +
geom_raster() +
scale_fill_gradient(low = "white", high = "black") +
labs(x = "x",
y = "y") +
theme(aspect.ratio = 1) +
facet_wrap(~ observation_id)
scores <- scores |>
select(row, PC1, PC2, PC3, PC4)
pc1_high <- scores |>
arrange(desc(PC1)) |>
head(4) |>
select(row) |>
as.vector()
one_image_data_tidy |>
filter(observation_id %in% pc1_high)
scores <- scores |>
select(row, PC1, PC2, PC3, PC4)
pc1_high <- scores |>
arrange(desc(PC1)) |>
head(4) |>
select(row) |>
as.vector()
one_image_data_tidy |>
glimpse()
scores <- scores |>
select(row, PC1, PC2, PC3, PC4)
pc1_high <- scores |>
arrange(desc(PC1)) |>
head(4) |>
select(row) |>
as.vector()
pc1_high
one_image_data_tidy |>
filter(observation_id == 590)
one_image_data_tidy |>
filter(observation_id == 590 |
observation_id == 1069 |
observation_id == 43 |
observation_id == 2867)
one_image_data_tidy |>
filter(observation_id == 590 |
observation_id == 1069 |
observation_id == 43 |
observation_id == 2867) |>
ggplot(aes(x = as.numeric(x), y = as.numeric(y), fill = value)) +
geom_raster() +
scale_fill_gradient(low = "white", high = "black") +
labs(x = "x",
y = "y") +
theme(aspect.ratio = 1) +
facet_wrap(~ observation_id)
scores <- scores |>
select(row, PC1, PC2, PC3, PC4)
pc1_high <- scores |>
arrange(desc(PC1)) |>
head(4) |>
select(row) |>
list()
pc1_high
one_image_data_tidy |>
filter(observation_id %in% pc1_high) |>
ggplot(aes(x = as.numeric(x), y = as.numeric(y), fill = value)) +
geom_raster() +
scale_fill_gradient(low = "white", high = "black") +
labs(x = "x",
y = "y") +
theme(aspect.ratio = 1) +
facet_wrap(~ observation_id)
one_image_data_tidy |>
filter(observation_id == 590 |
observation_id == 1069 |
observation_id == 43 |
observation_id == 2867) |>
ggplot(aes(x = as.numeric(x), y = as.numeric(y), fill = value)) +
geom_raster() +
scale_fill_gradient(low = "white", high = "black") +
labs(x = "x",
y = "y") +
theme(aspect.ratio = 1) +
facet_wrap(~ observation_id)
scores <- scores |>
select(row, PC1, PC2, PC3, PC4)
pc1_high <- scores |>
arrange(desc(PC1)) |>
head(4) |>
select(row) |>
as.vector()
pc1_high
one_image_data_tidy |>
filter(observation_id == 590 |
observation_id == 1069 |
observation_id == 43 |
observation_id == 2867) |>
ggplot(aes(x = as.numeric(x), y = as.numeric(y), fill = value)) +
geom_raster() +
scale_fill_gradient(low = "white", high = "black") +
labs(x = "x",
y = "y") +
theme(aspect.ratio = 1) +
facet_wrap(~ observation_id)
pc1_low <- scores |>
arrange((PC1)) |>
head(4) |>
select(row) |>
as.vector()
pc1_low
pc1_low <- scores |>
arrange((PC1)) |>
head(4) |>
select(row) |>
as.vector()
pc1_low
one_image_data_tidy |>
filter(observation_id == 2290 |
observation_id == 472 |
observation_id == 4040 |
observation_id == 1515) |>
ggplot(aes(x = as.numeric(x), y = as.numeric(y), fill = value)) +
geom_raster() +
scale_fill_gradient(low = "white", high = "black") +
labs(x = "x",
y = "y") +
theme(aspect.ratio = 1) +
facet_wrap(~ observation_id)
pc2_high <- scores |>
arrange(desc(PC2)) |>
head(4) |>
select(row) |>
as.vector()
pc2_high
one_image_data_tidy |>
filter(observation_id == 14 |
observation_id == 1037 |
observation_id == 2069 |
observation_id == 2506) |>
ggplot(aes(x = as.numeric(x), y = as.numeric(y), fill = value)) +
geom_raster() +
scale_fill_gradient(low = "white", high = "black") +
labs(x = "x",
y = "y") +
theme(aspect.ratio = 1) +
facet_wrap(~ observation_id)
pc2_low <- scores |>
arrange((PC2)) |>
head(4) |>
select(row) |>
as.vector()
pc2_low
one_image_data_tidy |>
filter(observation_id == 3317 |
observation_id == 886 |
observation_id == 2360 |
observation_id == 3055) |>
ggplot(aes(x = as.numeric(x), y = as.numeric(y), fill = value)) +
geom_raster() +
scale_fill_gradient(low = "white", high = "black") +
labs(x = "x",
y = "y") +
theme(aspect.ratio = 1) +
facet_wrap(~ observation_id)
pc3_high <- scores |>
arrange(desc(PC3)) |>
head(4) |>
select(row) |>
as.vector()
pc3_high
one_image_data_tidy |>
filter(observation_id == 147 |
observation_id == 226 |
observation_id == 3705 |
observation_id == 489) |>
ggplot(aes(x = as.numeric(x), y = as.numeric(y), fill = value)) +
geom_raster() +
scale_fill_gradient(low = "white", high = "black") +
labs(x = "x",
y = "y") +
theme(aspect.ratio = 1) +
facet_wrap(~ observation_id)
pc3_low <- scores |>
arrange((PC3)) |>
head(4) |>
select(row) |>
as.vector()
pc3_low
one_image_data_tidy |>
filter(observation_id == 4575 |
observation_id == 3807 |
observation_id == 4395 |
observation_id == 418) |>
ggplot(aes(x = as.numeric(x), y = as.numeric(y), fill = value)) +
geom_raster() +
scale_fill_gradient(low = "white", high = "black") +
labs(x = "x",
y = "y") +
theme(aspect.ratio = 1) +
facet_wrap(~ observation_id)
pc4_high <- scores |>
arrange(desc(PC4)) |>
head(4) |>
select(row) |>
as.vector()
pc4_high
one_image_data_tidy |>
filter(observation_id == 678 |
observation_id == 1037 |
observation_id == 14 |
observation_id == 1680) |>
ggplot(aes(x = as.numeric(x), y = as.numeric(y), fill = value)) +
geom_raster() +
scale_fill_gradient(low = "white", high = "black") +
labs(x = "x",
y = "y") +
theme(aspect.ratio = 1) +
facet_wrap(~ observation_id)
pc4_low <- scores |>
arrange((PC4)) |>
head(4) |>
select(row) |>
as.vector()
pc4_low
one_image_data_tidy |>
filter(observation_id == 1118 |
observation_id == 3187 |
observation_id == 1101 |
observation_id == 1312) |>
ggplot(aes(x = as.numeric(x), y = as.numeric(y), fill = value)) +
geom_raster() +
scale_fill_gradient(low = "white", high = "black") +
labs(x = "x",
y = "y") +
theme(aspect.ratio = 1) +
facet_wrap(~ observation_id)
